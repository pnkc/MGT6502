# Bryson Cook
# MGT6502x, Summer 2018 HW3
rm(list = ls())
cat("\014")
set.seed(1)
#install.packages("ISLR")
library(ISLR)
#install.packages("dplyr")
library(dplyr)
data = data.frame(Weekly)
tail(data,200)
model1 = glm(Direction~Lag1+Lag2+Lag3+Lag4+Lag5+Volume, data =data, family = "binomial")
summary(model1)
data1 = data %>%
mutate(pred_mod1 = predict(model1, newdata =., type='response')) %>%
mutate(pred_out1 = ifelse(pred_mod1 >= 0.5,1,0))
xtabs(~Direction+pred_out1, data =data1)
#Problem 7
data2 = data[1:985,]
tail(data2)
model2 = glm(Direction~Lag2, data =data2, family = "binomial")
summary(model1)
data3 = data[986:1089,]
data3 = data3 %>%
mutate(pred_mod2 = predict(model2, newdata =data3, type='response')) %>%
mutate(pred_out2 = ifelse(pred_mod2 >= 0.5,1,0))
head(data3)
xtabs(~Direction+pred_out2, data =data3)
# Bryson Cook
# MGT6502x, Summer 2018 HW3
rm(list = ls())
cat("\014")
set.seed(1)
#install.packages("ISLR")
library(ISLR)
#install.packages("dplyr")
library(dplyr)
data = data.frame(Weekly)
tail(data,200)
model1 = glm(Direction~Lag1+Lag2+Lag3+Lag4+Lag5+Volume, data =data, family = "binomial")
summary(model1)
data1 = data %>%
mutate(pred_mod1 = predict(model1, newdata =., type='response')) %>%
mutate(pred_out1 = ifelse(pred_mod1 >= 0.5,1,0))
xtabs(~Direction+pred_out1, data =data1)
#Problem 7
data2 = data[1:985,]
model2 = glm(Direction~Lag2, data =data2, family = "binomial")
summary(model1)
data3 = data[986:1089,]
data3 = data3 %>%
mutate(pred_mod2 = predict(model2, newdata =data3, type='response')) %>%
mutate(pred_out2 = ifelse(pred_mod2 >= 0.5,1,0))
head(data3)
xtabs(~Direction+pred_out2, data =data3)
# Bryson Cook
# MGT6502x, Summer 2018 HW3
rm(list = ls())
cat("\014")
set.seed(1)
#install.packages("ISLR")
library(ISLR)
#install.packages("dplyr")
library(dplyr)
data = data.frame(Weekly)
model1 = glm(Direction~Lag1+Lag2+Lag3+Lag4+Lag5+Volume, data =data, family = "binomial")
summary(model1)
data1 = data %>%
mutate(pred_mod1 = predict(model1, newdata =., type='response')) %>%
mutate(pred_out1 = ifelse(pred_mod1 >= 0.5,1,0))
xtabs(~Direction+pred_out1, data =data1)
#Problem 7
data2 = data[1:985,]
model2 = glm(Direction~Lag2, data =data2, family = "binomial")
summary(model1)
data3 = data[986:1089,]
data3 = data3 %>%
mutate(pred_mod2 = predict(model2, newdata =data3, type='response')) %>%
mutate(pred_out2 = ifelse(pred_mod2 >= 0.5,1,0))
head(data3)
xtabs(~Direction+pred_out2, data =data3)
